<!DOCTYPE html>
<html>
<head>
  <title>Inventory Gallery</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f6f8fb;
      margin: 0;
      padding: 0;
      color: #253050;
    }
    h1 {
      color: #3561b4;
      font-size: 2.15rem;
      letter-spacing: 2px;
      text-align: center;
      margin-top: 36px;
      margin-bottom: 20px;
    }
    #search-container {
      text-align: center;
      margin-bottom: 22px;
    }
    #item-search {
      width: 390px;
      max-width: 93vw;
      padding: 12px 18px;
      font-size: 1em;
      border: 1.5px solid #b6b6e5;
      border-radius: 8px;
      box-shadow: 0 1px 7px #2252c02d;
      transition: border 0.2s;
      margin-bottom: 5px;
    }
    #item-search:focus {
      border: 2px solid #4871e8;
      outline: none;
    }
    table {
      border-collapse: collapse;
      width: 96%;
      margin: 0 auto 32px auto;
      background: #fff;
      box-shadow: 0 4px 24px #192f6110;
      border-radius: 11px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #e0e7f1;
      padding: 8px 14px;
      text-align: left;
      font-size: 1.02em;
    }
    th {
      background-color: #ecf4fd;
      color: #2d4fa6;
      font-weight: 600;
      font-size: 1.06em;
    }
    tr.data-row:nth-child(even) td {
      background: #f7faff;
    }
    tr.data-row:hover td {
      background: #eaeefc;
    }
    img {
      max-width: 110px;
      max-height: 78px;
      border-radius: 7px;
      box-shadow: 0 1px 4px #4068db19;
    }
    a {
      color: #3961cf;
      text-decoration: none;
      transition: color 0.16s;
    }
    a:hover { text-decoration: underline; color: #2747b8; }
    @media (max-width: 580px) {
      table { font-size: .90em; }
      #item-search { width: 99vw; }
      th, td { padding: 5px 4px; }
    }
  </style>
</head>
<body>
  <h1>Inventory Items</h1>
  <div id="search-container">
    <input id="item-search" type="text" placeholder="Search items by any info..." autocomplete="off">
  </div>
  <table id="inventory">
    <thead>
      <tr>
        <th>Date</th>
        <th>ItemID</th>
        <th>Qty</th>
        <th>Description</th>
        <th>Shipper</th>
        <th>Client</th>
        <th>Item#</th>
        <th>PO#</th>
        <th>Image</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <script>
    // Render the table
    fetch('/api/items')
      .then(response => response.json())
      .then(data => {
        const tbody = document.querySelector('#inventory tbody');
        data.forEach(row => {
          tbody.innerHTML += `<tr class="data-row">
            <td>${row.date || ''}</td>
            <td>${row.item_id || ''}</td>
            <td>${row.qty || ''}</td>
            <td>${row.description || ''}</td>
            <td>${row.shipper || ''}</td>
            <td>${row.client_url ? `<a href="${row.client_url}" target="_blank">${row.client||''}</a>` : (row.client||'')}</td>
            <td>${row.item_num || ''}</td>
            <td>${row.po_num || ''}</td>
            <td>${row.image_file && row.image_file !== '' ?
                `<a href="/${row.image_file}" target="_blank">
                   <img src="/${row.image_file}" alt="item image"></a>`
                :
                'No image'
              }
            </td>
          </tr>`;
        });
      });

    // Search filter logic
    document.getElementById('item-search').addEventListener('input', function() {
      const q = this.value.trim().toLowerCase();
      document.querySelectorAll("#inventory tbody tr.data-row").forEach(tr => {
        tr.style.display = Array.from(tr.children).some(td =>
            td.textContent.toLowerCase().includes(q)
        ) ? "" : "none";
      });
    });
  </script>
</body>
</html>
